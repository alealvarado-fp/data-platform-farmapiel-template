@startuml C4_Component_Dataplex
!include https://raw.githubusercontent.com/plantuml-stdlib/C4-PlantUML/master/C4_Component.puml

System(dataplex, "Google Dataplex", "Linaje y Gobernanza")
ContainerDb(bq, "BigQuery", "Data Warehouse")

Container_Boundary(ingesta_logic, "Proceso de Ingesta (DAG / API)") {
    Component(transformer, "Data Transformer", "Python", "Aplica lógica de negocio e idempotencia")
    Component(governance_tagger, "Governance Tagger", "Python SDK", "Asigna etiquetas (dominio, origen, proveedor) para Dataplex")
    Component(bq_operator, "BigQuery Operator", "Airflow/GCP SDK", "Ejecuta el MERGE SQL con labels de gobernanza")
}

Rel(transformer, governance_tagger, "Prepara metadatos")
Rel(governance_tagger, bq_operator, "Inyecta labels")
Rel(bq_operator, bq, "Ejecuta Query + Labels")

Rel(bq, dataplex, "Reporta linaje de ejecución", "Automatic")
@enduml